"use strict";var BP={ui:{scoreElm:document.querySelector(".score"),introElm:document.querySelector(".intro"),levelsElm:document.querySelector(".levels"),levelMsg:document.querySelector(".levels").firstElementChild,startBtn:document.querySelector(".start"),canvas:document.getElementById("canvas"),size:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight},ctx:document.getElementById("canvas").getContext("2d"),mouse:{x:void 0,y:void 0}},util:{fadeIn:function(e,i){if(e)if(e.style.opacity=0,e.style.filter="alpha(opacity=0)",e.style.display="inline-block",e.style.visibility="visible",i)var t=0,a=setInterval(function(){t+=50/i,t>=1&&(clearInterval(a),t=1),e.style.opacity=t,e.style.filter="alpha(opacity="+100*t+")"},50);else e.style.opacity=1,e.style.filter="alpha(opacity=1)"},fadeOut:function(e,i){if(e)if(i)var t=1,a=setInterval(function(){t-=50/i,t<=0&&(clearInterval(a),t=0,e.style.display="none",e.style.visibility="hidden"),e.style.opacity=t,e.style.filter="alpha(opacity="+100*t+")"},50);else e.style.opacity=0,e.style.filter="alpha(opacity=0)",e.style.display="none",e.style.visibility="hidden"},randomColorGen:function(){return Math.floor(255*Math.random())+1+", "+(Math.floor(255*Math.random())+1)+", "+(Math.floor(255*Math.random())+1)}},bubblesQueue:[],bubble:function(e,i,t,a,s,l){this.x=e,this.y=i,this.dx=t,this.dy=a,this.radius=s,this.minRadius=s,this.colors=l,this.draw=function(){BP.ui.ctx.beginPath(),BP.ui.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),BP.ui.ctx.fillStyle=l,BP.ui.ctx.fill()},this.update=function(){(this.x+this.radius>innerWidth||this.x-this.radius<0)&&(this.dx=-this.dx),(this.y+this.radius>innerHeight||this.y-this.radius<0)&&(this.dy=-this.dy),this.x+=this.dx,this.y+=this.dy,BP.ui.mouse.x-this.x<this.minRadius&&BP.ui.mouse.x-this.x>-this.minRadius&&BP.ui.mouse.y-this.y<this.minRadius&&BP.ui.mouse.y-this.y>-this.minRadius&&0!=this.radius?(this.radius+=BP.gamePlay.bubbleExpansionRate,this.radius>BP.gamePlay.maxExpansion&&this.destroy()):this.radius>this.minRadius&&0!=this.radius&&(this.radius-=BP.gamePlay.bubbleExpansionRate,BP.ui.mouse.x=0,BP.ui.mouse.y=0),this.draw()},this.destroy=function(){this.radius=0,this.x=-10,this.y=-10,this.dx=0,this.dy=0,BP.gamePlay.bubblesPoppedPerLevel+=1,BP.gamePlay.bubblesPoppedTotal+=1,BP.gamePlay.checkProgress()}},bubbleMultiplier:function(){this.bubblesQueue=[];for(var e=this.gamePlay.bubbleQnty-BP.gamePlay.bubblesPoppedPerLevel,i=0;i<e;i++){var t=Math.floor(Math.random()*BP.gamePlay.maxRadius)+25,a=Math.random()*(innerWidth-2*t)+t,s=Math.random()*(innerHeight-2*t)+t,l=(Math.random()-.5)*BP.gamePlay.speed,n=(Math.random()-.5)*BP.gamePlay.speed,u=.85*Math.random()+.15,o="rgba("+BP.util.randomColorGen()+" , "+u+")",r=[a,s,l,n,t,o];this.bubblesQueue.push(new(Function.prototype.bind.apply(BP.bubble,[null].concat(r))))}},animate:function(){requestAnimationFrame(BP.animate),BP.ui.ctx.clearRect(0,0,innerWidth,innerHeight);for(var e=0;e<BP.bubblesQueue.length;e++)BP.bubblesQueue[e].update()},gamePlay:{level:1,bubbleQnty:50,bubblesPoppedPerLevel:0,bubblesPoppedTotal:0,bubbleExpansionRate:5,speed:8,maxRadius:45,maxExpansion:150,start:function(){BP.ui.canvas.addEventListener("mousemove",function(e){BP.ui.mouse.x=e.x,BP.ui.mouse.y=e.y},!1),BP.gamePlay.speed=3,BP.gamePlay.bubbleQnty=8,BP.ui.canvas.classList.add("active"),BP.util.fadeOut(BP.ui.introElm,200),BP.bubbleMultiplier()},checkProgress:function(){this.bubblesPoppedPerLevel===this.bubbleQnty&&(this.bubblesPoppedPerLevel=0,BP.gamePlay.level+=1,BP.ui.canvas.classList.remove("active"),this.showHideLevelMsg())},showHideLevelMsg:function(){var e=this,i="color:rgba("+BP.util.randomColorGen()+" , 1)";BP.ui.levelMsg.setAttribute("style",i),BP.ui.levelMsg.innerHTML="Level "+BP.gamePlay.level;var t=setTimeout(function(){clearTimeout(t),BP.util.fadeIn(BP.ui.levelsElm,800);var i=setTimeout(function(){clearTimeout(i),BP.util.fadeOut(BP.ui.levelsElm,600),e.nextLevel()},4e3)},200)},nextLevel:function(){BP.gamePlay.speed+=.5,BP.gamePlay.bubbleQnty+=5,BP.gamePlay.maxRadius+15<BP.gamePlay.maxExpansion&&(BP.gamePlay.maxExpansion-=5);var e=setTimeout(function(){clearTimeout(e),BP.bubbleMultiplier(),BP.ui.canvas.classList.add("active")},800)}},bind:function(){this.ui.startBtn.addEventListener("click",this.gamePlay.start),window.addEventListener("resize",function(){BP.ui.canvas.width=window.innerWidth,BP.ui.canvas.height=window.innerHeight,0!=BP.gamePlay.bubblesPoppedPerLevel&&BP.bubbleMultiplier()})},init:function(){this.ui.size(),this.bubbleMultiplier(),this.animate(),this.bind()}};BP.init();